{
    "DCU on Large Enterprise SCCM Networks -Bandwidth  Concerns-": {
        "title": "DCU on Large Enterprise SCCM Networks -Bandwidth  Concerns-",
        "score": 5,
        "url": "https://www.reddit.com/r/SCCM/comments/1dqmdpi/dcu_on_large_enterprise_sccm_networks_bandwidth/",
        "content": "I work on a network that has around 10k devices managed in SCCM. We want to roll out Dell Command Update, but networking and security departments are concerned about bandwidth usage when DCU pulls updates from the internet. I suggested creating multiple configurations of the application with separate schedules so all the devices aren't attempting to update at once. But I wanted to know if anyone has come up with a better strategy for this. Seeing as how we have so many devices that we manage, I'm going to need to find a sweet spot for bandwidth that security and network departments are happy with. I've noticed BIOS exe files (the main reason we are wanting to utilize DCU) can be anywhere between 20-50 MB, so I wanted to find out what solutions and strategies others have come up with to avoid bandwidth issues with DCU on larger enterprise networks. Do you create several collections and several software configurations? How many devices do you include in each collection for production rings? Or do you not experience any bandwidth issues at all? OR, is there a better way to go about this entirely, other than using Dell Command Update? I appreciate any input. Thanks.",
        "num_comments": 18,
        "comments": [
            "Got 100mb fiber at our second site with about ~250 people, and splitting laptop/desktop into 9am/9pm, and laptops still crush the bandwidth a few months into weekly updates. And thats after going down a traffic shaping rabbithole.\n\ndo the offline cache.",
            "We have \"random\" collections that are populated by the last character of the sms guid.  Combining those with model and site for targeting is how we spread out the load.\n\nIt's too bad DCU uses foreground mode for bits transfers.  Would have been nice to be able to rely on our existing throttling policies for added protection.",
            "I just decided to only update bios and network drivers using an SCCM application. Then our service desk will work with clients for a full driver install if users complain about graphics or slow PC issues.",
            "I had experience with this and tried to do our own onsite cache for drivers and gave up. Then I just used PSADTK with custom parameters for model (optiplex,precision,latitude), model number, and update type so we can just trigger whatever models we want. Then I figured that was too much work and just used one package to rule them all with just update type as a parameter and then i have a collection specific for every model we can run whenever we want. Right now I really only do bios and network. Also all our DCU clients are set to manual updates, they never auto scan.  \n  \nWe have about 34k clients and our biggest model count is about 3200 of a single model, networking hasnt complained at all. Oh and i did put in a random counter to offset the start time of the DCU portion of the script so they all one trigger at the same time no matter what but they have 2 hours to run.",
            "We have it deployed in our enterprise of about 7000 workstation endpoints and it hasn't caused any major issues. But yeah, local repository can alleviate that.",
            "yeah! internet bandwidth is what they're mostly concerned about. thanks for the link. Going to look into this.",
            "Oof. That's rough. I feel for you.",
            "Do you use dcu-cli scheduling or just deploy a package that checks for/installs updates on different recurring schedules?",
            "Tgought about using get-random to do this to schedule within the dcu-cli.exe configuration script too, which is most likely what I'll be using as it seems like the best option so far. But without using a scheduled task and just automating the settings with the -schedulemonthly parameter. thanks for that.",
            "The latter.  That way we can still do it during our existing maintenance windows.  We also use psadt to display a reboot warning before initiating a restart when needed."
        ]
    },
    "Removing device from software updates - What device settings are removed?": {
        "title": "Removing device from software updates - What device settings are removed?",
        "score": 5,
        "url": "https://www.reddit.com/r/SCCM/comments/1dqfrto/removing_device_from_software_updates_what_device/",
        "content": "Hi!\n\nI'm trying to move some of our clients getting their Windows updates from our local WSUS server via SCCM to NinjaOne since they rarely connect to our VPN and therefore get no updates at all. \n\nIf a user is connected to our internal network and I exclude them from getting Software Updates and let some policy evaluations run so SCCM removes the settings everything works perfectly fine and they can later get Windows Updates via NinjaOne without being on our internal network.\n\nHowever, in an ideal world I should be able to move them to NinjaOne without needing them to connect to the VPN again. It seems like SCCM is setting up some local group policies pointing towards our WSUS server, so I have removed all of these settings and deleted HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\ to let it get created again by NinjaOne, but somehow the device will still try to connect to our WSUS server and I get the following error message:\n\n\"Patch management scan FAILED to complete. ERROR: Patch management scan FAILED to complete. Error:[-3005 Windows communication error, Find failed when performing missing patch search] [Windows error code: 0x8024402c, description: Same as ERROR_WINHTTP_NAME_NOT_RESOLVED - the proxy server or target server name cannot be resolved.]\"\n\nIf I do a search of the entire registry for our wsus server it returns nothing, so there are no traces of it there, however the windowsupdate.log shows the adress is still in the game somehow. I have also tried a flushdns, but that helped nothing.\n\nAnyone of you wizards have any idea what other setting SCCM sets up on the client that it can remove itself, but I am somehow missing?",
        "num_comments": 13,
        "comments": [
            "The SCCM client settings are what are creating the WSUS reg settings. To remove that permanently, you'll need to create another client setting that doesn't have the software update settings, and deploy it to a collection that includes the devices you don't want getting the WSUS settings, that has a higher priority than the normal client setting.",
            "I totally agree this isn't an actual solution. We are however slowly transitioning to Intune for these devices so NinjaOne is just a temporary solution deemed better than them getting no updates at all in the meantime. For more 'reasons' my boss isn't that interested in AOVPN.\n\nThank you for your response!",
            "That is exactly what I did and what works. But surely there has to be a way to manually revert the same settings SCCM reverts when I turn off Software Updates in the Client Setting?\n\nIf not it is impossible to change update source on a computer that is not in contact with SCCM?",
            "Hmm, is there a reason not to just enable co-management and get these devices' updates managed by Intune then? Literally free from a licensing standpoint and if that's your desired end-state anyways seems like it'd eliminated wasted effort of moving twice. Configuring updates is pretty straight-forward in Intune since there's just not a whole lot there.",
            "Correct, because the agent will continue to reapply whatever settings it currently knows about. So until it connects to the VPN and gets policy updates, it's going to continue reverting your manual changes.",
            "The devices as they are now contain quite sensitive data that we don't want connected to Microsoft any more than we absolutely have to. When we finally switch to Intune we will switch out the entire device.",
            "<scratches head> Hmmmkay, sounds like some super fun discussions are going on internally. Wish you the best of luck there, those can be a real hoot.",
            "The agent will reapply the settings every 15 minutes (I think), so it may just be a case of bad timing. However, IIRC you would also need to restart the WSUS service after making the registry changes.",
            "I tried that too. I've even rebooted the computer and it still doesn't work even though I can see that SCCM has not yet reapplied the settings in the registry.",
            "Oh, you bet! \ud83d\ude0a"
        ]
    },
    "ADR not working for HP Client Updates Catalog": {
        "title": "ADR not working for HP Client Updates Catalog",
        "score": 0,
        "url": "https://www.reddit.com/r/SCCM/comments/1dqploj/adr_not_working_for_hp_client_updates_catalog/",
        "content": "I'm trying to leverage the HP Client Updates Catalog to do driver updates. I can see all the updates in the \"All Software Updates\" view, but when I try to setup the ADR and run it, no SUG is created, and the DP remains empty. When I go into the ADR properties and look at the preview, no updates are returned, but if I put the same criteria into the All Software Updates view, the updates show. 3rd party updates are enabled, and we have been successfully deploying software updates with PatchMyPC for some time now. Any idea where I am going wrong?\n\n[No updates showing in ADR view](https://preview.redd.it/l484vdvhnc9d1.png?width=1358&format=png&auto=webp&s=30358f00c48d98c1a4c39ecda5f196e9d70e050b)\n\n[Updates are showing in All Software Updates view](https://preview.redd.it/68zikbtlnc9d1.png?width=1626&format=png&auto=webp&s=a7710fbd53891b3b334e9a89bfa0fcee6525277e)\n\nEDIT:  \nLooking at ruleengine.log, it appears the rule is running without error, but the query is returning 0 updates.\n\n[ruleengine.log](https://preview.redd.it/2hverxq9pc9d1.png?width=1898&format=png&auto=webp&s=b2f7b9565eb912d42f8e284319e6733187db0412)\n\n  \n",
        "num_comments": 2,
        "comments": [
            "The blue icon means that those drivers haven't been published yet, and you won't be able to use them in an ADR until they are.  You will need to select them, choose \"Publish Third-Party Software Update Content\" and they will eventually be available for you to use.",
            "I'd personally look into using HPIA for keeping your device drivers and BIOS updated.  \nYou can be as creative as you want with that.  Task Sequence, Configuration Items, Scheduled Tasks, etc.\n\nYou could also look into MIK and leverage HP Patch Assistant\n\nThe last thing I'd personally use are the OEM 3rd party update catalogs. It adds a lot of things into the WSUS Database, so make sure you're doing regular maintenance to clean that up."
        ]
    },
    "Wimwitchfk .NET update failing to inject. Error code = 0x800f081e": {
        "title": "Wimwitchfk .NET update failing to inject. Error code = 0x800f081e",
        "score": 2,
        "url": "https://www.reddit.com/r/SCCM/comments/1dqcv0q/wimwitchfk_net_update_failing_to_inject_error/",
        "content": "Hi Guys\n\nWimwitchfk newb here.\n\nHad a go injecting latest updates to the wim from May 2024 ISO (Win10 22H2 ENT).\n\nOSDSUS and OSDUPDATE are both on latest version.\n\nThe June CU (KB5039211) seems to inject fine.\n\nHowever, these .NET ones are failing to inject.\n\nWARNING: Failed to add package C:\\\\WimWitch\\\\updates\\\\Windows 10\\\\22H2\\\\DotNetCU\\\\2024-04 Cumulative Update for .NET\n\nFramework 3.5 4.8 and 4.8.1 for Windows 10 Version 22H2 for x64 (KB5037036)\\\\Windows10.0-KB5036618-x64-NDP481.cab\n\nWARNING: Add-WindowsPackage failed. Error code = 0x800f081e\n\n06/28/2024 15:33:15 Warning  -  Failed to apply update\n\n06/28/2024 15:33:15 Warning  -  Add-WindowsPackage failed. Error code = 0x800f081e\n\n\n\nWARNING: Failed to add package C:\\\\WimWitch\\\\updates\\\\Windows 10\\\\22H2\\\\DotNetCU\\\\2024-05 Cumulative Update for .NET\n\nFramework 3.5 4.8 and 4.8.1 for Windows 10 Version 22H2 for x64 (KB5038285)\\\\Windows10.0-KB5037587-x64-NDP481.cab\n\nWARNING: Add-WindowsPackage failed. Error code = 0x800f081e\n\n06/28/2024 15:33:15 Warning  -  Failed to apply update\n\n06/28/2024 15:33:15 Warning  -  Add-WindowsPackage failed. Error code = 0x800f081e\n\n  \nIf anyone have any suggestions on this?\n\nI thought being MAY 2024 ISO, could be the issue. So tried it again with an older ISO, but same errors.\n\n  \nThanks",
        "num_comments": 2,
        "comments": [
            "Alright... after some investigation... it appears Win10 22H2 do not include .Net 4.8.1. So maybe that is why it is failing. So then, why is Wimwitchfk trying to install these .NET 4.8.1 updates....",
            "Yep you need to grab the cab for the .net 4.8.1 install from the windows update catalog site & add it to the .net updates folder for wimwitch.\n\nI haven\u2019t used the forked version yet, but this works with the OG."
        ]
    },
    "Low MCC usage - DO Timeout query": {
        "title": "Low MCC usage - DO Timeout query",
        "score": 4,
        "url": "https://www.reddit.com/r/SCCM/comments/1dq53do/low_mcc_usage_do_timeout_query/",
        "content": "I have deployed Microsoft Connected Cache (MCC) and have Windows Updates comanagement slider toggled across to Pilot Intune and configured on most PCs. MCC is installed and working on DPs. Clients are configured as Group Mode: AD Site with no subnet restriction. Using DeliveryOptimizationTroubleshooter I can see clients using P2P and MCC. However, the Azure Windows Update for Business Reports shows that MCC usage is a low 10-15% and seems to have dropped from first introduced from \\~30% and overall CDN usage is up.\n\nI am reviewing settings/config to tweak and notice the following from MS: [Delivery Optimization reference - Windows Deployment | Microsoft Learn](https://learn.microsoft.com/en-us/windows/deployment/do/waas-delivery-optimization-reference#microsoft-connected-cache-mcc-delay-fallback-settings)  \n***If both peer-to-peer and MCC are configured, the peer-to-peer delay settings will take precedence over the cache server delay settings.***\u00a0*This setting allows Delivery Optimization to discover peers first then recognize the fallback setting for the MCC cache server.*\n\nDoes this mean if you have a P2P fallback value (DO Delay Background Download From Http: 300) configured lower than cache fallback value (DO Delay Cache Server Fallback Background: eg 1200) \u2014 that after 300 seconds, fallback to CDN may be done by the client instead of also waiting for MCC fallback? I am wondering if these timeouts are cumulative or concurrent.",
        "num_comments": 0,
        "comments": []
    }
}